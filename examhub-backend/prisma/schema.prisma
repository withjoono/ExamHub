generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model Student {
  id                 Int                 @id @default(autoincrement())
  studentId          String              @unique @map("student_id") @db.VarChar(20)
  year               Int
  schoolLevel        String?             @map("school_level") @db.VarChar(10)
  schoolName         String?             @map("school_name") @db.VarChar(100)
  grade              String?             @db.VarChar(10)
  name               String              @db.VarChar(50)
  schoolType         String?             @map("school_type") @db.VarChar(20)
  phone              String?             @db.VarChar(20)
  parentPhone        String?             @map("parent_phone") @db.VarChar(20)
  email              String?             @db.VarChar(100)
  parentEmail        String?             @map("parent_email") @db.VarChar(100)
  createdAt          DateTime            @default(now()) @map("created_at")
  updatedAt          DateTime            @updatedAt @map("updated_at")
  achievementResults AchievementResult[]
  answers            StudentAnswer[]
  scores             StudentScore[]
  targets            StudentTarget[]

  @@index([studentId])
  @@index([year, grade])
  @@map("eh_students")
}

model MockExam {
  id                      Int                       @id @default(autoincrement())
  code                    String                    @unique @db.VarChar(20)
  name                    String                    @db.VarChar(100)
  grade                   String?                   @db.VarChar(10)
  year                    Int?
  month                   Int?
  type                    String?                   @db.VarChar(20)
  createdAt               DateTime                  @default(now()) @map("created_at")
  admissionCutoffs        AdmissionCutoff[]
  questions               ExamQuestion[]
  scoreConversionRaw      ScoreConversionRaw[]
  scoreConversionStandard ScoreConversionStandard[]
  studentAnswers          StudentAnswer[]
  studentScores           StudentScore[]

  @@index([code])
  @@index([grade, year, month])
  @@map("eh_mock_exams")
}

model SubjectArea {
  id           Int           @id @default(autoincrement())
  code         String        @unique @db.VarChar(10)
  name         String        @db.VarChar(50)
  subjectCodes SubjectCode[]

  @@map("eh_subject_areas")
}

model SubjectCode {
  id            Int         @id @default(autoincrement())
  subjectAreaId Int         @map("subject_area_id")
  code          String      @unique @db.VarChar(10)
  name          String      @db.VarChar(50)
  subjectArea   SubjectArea @relation(fields: [subjectAreaId], references: [id])

  @@index([subjectAreaId])
  @@map("eh_subject_codes")
}

model SubjectChapter {
  id              Int     @id @default(autoincrement())
  subjectAreaCode String? @map("subject_area_code") @db.VarChar(10)
  subjectCode     String? @map("subject_code") @db.VarChar(10)
  majorName       String? @map("major_name") @db.VarChar(100)
  majorCode       String? @map("major_code") @db.VarChar(10)
  minorName       String? @map("minor_name") @db.VarChar(200)
  minorCode       String? @map("minor_code") @db.VarChar(10)

  @@index([subjectAreaCode, subjectCode])
  @@map("eh_subject_chapters")
}

model ExamQuestion {
  id              Int             @id @default(autoincrement())
  mockExamId      Int             @map("mock_exam_id")
  subjectAreaCode String?         @map("subject_area_code") @db.VarChar(10)
  subjectAreaName String?         @map("subject_area_name") @db.VarChar(50)
  subjectCode     String?         @map("subject_code") @db.VarChar(10)
  subjectName     String?         @map("subject_name") @db.VarChar(50)
  questionNumber  Int             @map("question_number")
  score           Int
  answer          Int
  choiceRatio1    Decimal?        @map("choice_ratio_1") @db.Decimal(5, 2)
  choiceRatio2    Decimal?        @map("choice_ratio_2") @db.Decimal(5, 2)
  choiceRatio3    Decimal?        @map("choice_ratio_3") @db.Decimal(5, 2)
  choiceRatio4    Decimal?        @map("choice_ratio_4") @db.Decimal(5, 2)
  choiceRatio5    Decimal?        @map("choice_ratio_5") @db.Decimal(5, 2)
  correctRate     Decimal?        @map("correct_rate") @db.Decimal(5, 2)
  difficulty      String?         @db.VarChar(10)
  mockExam        MockExam        @relation(fields: [mockExamId], references: [id])
  studentAnswers  StudentAnswer[]

  @@index([mockExamId])
  @@index([subjectAreaCode, subjectCode])
  @@map("eh_exam_questions")
}

model StudentScore {
  id                 Int      @id @default(autoincrement())
  studentId          Int      @map("student_id")
  mockExamId         Int      @map("mock_exam_id")
  koreanSelection    String?  @map("korean_selection") @db.VarChar(20)
  koreanRaw          Int?     @map("korean_raw")
  koreanStandard     Int?     @map("korean_standard")
  koreanPercentile   Decimal? @map("korean_percentile") @db.Decimal(5, 2)
  koreanGrade        Int?     @map("korean_grade")
  englishRaw         Int?     @map("english_raw")
  englishGrade       Int?     @map("english_grade")
  mathSelection      String?  @map("math_selection") @db.VarChar(20)
  mathRaw            Int?     @map("math_raw")
  mathStandard       Int?     @map("math_standard")
  mathPercentile     Decimal? @map("math_percentile") @db.Decimal(5, 2)
  mathGrade          Int?     @map("math_grade")
  inquiry1Selection  String?  @map("inquiry1_selection") @db.VarChar(50)
  inquiry1Raw        Int?     @map("inquiry1_raw")
  inquiry1Standard   Int?     @map("inquiry1_standard")
  inquiry1Percentile Decimal? @map("inquiry1_percentile") @db.Decimal(5, 2)
  inquiry1Grade      Int?     @map("inquiry1_grade")
  inquiry2Selection  String?  @map("inquiry2_selection") @db.VarChar(50)
  inquiry2Raw        Int?     @map("inquiry2_raw")
  inquiry2Standard   Int?     @map("inquiry2_standard")
  inquiry2Percentile Decimal? @map("inquiry2_percentile") @db.Decimal(5, 2)
  inquiry2Grade      Int?     @map("inquiry2_grade")
  historyRaw         Int?     @map("history_raw")
  historyGrade       Int?     @map("history_grade")
  foreignSelection   String?  @map("foreign_selection") @db.VarChar(50)
  foreignRaw         Int?     @map("foreign_raw")
  foreignGrade       Int?     @map("foreign_grade")
  totalStandardSum   Int?     @map("total_standard_sum")
  totalPercentileSum Decimal? @map("total_percentile_sum") @db.Decimal(6, 2)
  topCumulativeStd   Decimal? @map("top_cumulative_std") @db.Decimal(6, 2)
  topCumulativeRaw   Decimal? @map("top_cumulative_raw") @db.Decimal(6, 2)
  createdAt          DateTime @default(now()) @map("created_at")
  updatedAt          DateTime @updatedAt @map("updated_at")
  mockExam           MockExam @relation(fields: [mockExamId], references: [id])
  student            Student  @relation(fields: [studentId], references: [id])

  @@unique([studentId, mockExamId])
  @@index([studentId])
  @@index([mockExamId])
  @@map("eh_student_scores")
}

model StudentTarget {
  id             Int      @id @default(autoincrement())
  studentId      Int      @map("student_id")
  departmentCode String?  @map("department_code") @db.VarChar(20)
  priority       Int      @default(1)
  createdAt      DateTime @default(now()) @map("created_at")
  student        Student  @relation(fields: [studentId], references: [id])

  @@index([studentId])
  @@map("eh_student_targets")
}

model University {
  id             Int          @id @default(autoincrement())
  code           String       @unique @db.VarChar(10)
  name           String       @db.VarChar(100)
  shortName      String?      @map("short_name") @db.VarChar(50)
  region         String?      @db.VarChar(50)
  totalScore     Decimal?     @map("total_score") @db.Decimal(10, 2)
  conversionRate Decimal?     @map("conversion_rate") @db.Decimal(10, 6)
  status         String       @default("존립") @db.VarChar(20)
  departments    Department[]

  @@index([code])
  @@index([region])
  @@map("eh_universities")
}

model Department {
  id               Int               @id @default(autoincrement())
  code             String            @unique @db.VarChar(20)
  universityId     Int               @map("university_id")
  departmentCode   String?           @map("department_code") @db.VarChar(10)
  name             String            @db.VarChar(100)
  admissionType    String?           @map("admission_type") @db.VarChar(20)
  admissionGroup   String?           @map("admission_group") @db.VarChar(10)
  category         String?           @db.VarChar(20)
  subCategory      String?           @map("sub_category") @db.VarChar(50)
  quota            Int?
  selectionMethod  String?           @map("selection_method") @db.VarChar(20)
  scoreElements    String?           @map("score_elements") @db.VarChar(50)
  scoreCombination String?           @map("score_combination") @db.VarChar(50)
  requiredSubjects String?           @map("required_subjects") @db.VarChar(100)
  optionalSubjects String?           @map("optional_subjects") @db.VarChar(100)
  inquiryCount     Int?              @map("inquiry_count")
  koreanRatio      String?           @map("korean_ratio") @db.VarChar(20)
  mathRatio        String?           @map("math_ratio") @db.VarChar(20)
  englishRatio     String?           @map("english_ratio") @db.VarChar(20)
  inquiryRatio     String?           @map("inquiry_ratio") @db.VarChar(20)
  historyRatio     String?           @map("history_ratio") @db.VarChar(20)
  foreignRatio     String?           @map("foreign_ratio") @db.VarChar(20)
  koreanSelection  String?           @map("korean_selection") @db.VarChar(50)
  mathSelection    String?           @map("math_selection") @db.VarChar(50)
  probBonus        Decimal?          @map("prob_bonus") @db.Decimal(5, 2)
  calcBonus        Decimal?          @map("calc_bonus") @db.Decimal(5, 2)
  geometryBonus    Decimal?          @map("geometry_bonus") @db.Decimal(5, 2)
  inquiryType      String?           @map("inquiry_type") @db.VarChar(20)
  socialBonus      Decimal?          @map("social_bonus") @db.Decimal(5, 2)
  scienceBonus     Decimal?          @map("science_bonus") @db.Decimal(5, 2)
  mathScienceReq   String?           @map("math_science_req") @db.VarChar(50)
  englishScoreType String?           @map("english_score_type") @db.VarChar(20)
  englishGrade1    Decimal?          @map("english_grade_1") @db.Decimal(6, 2)
  englishGrade2    Decimal?          @map("english_grade_2") @db.Decimal(6, 2)
  englishGrade3    Decimal?          @map("english_grade_3") @db.Decimal(6, 2)
  englishGrade4    Decimal?          @map("english_grade_4") @db.Decimal(6, 2)
  englishGrade5    Decimal?          @map("english_grade_5") @db.Decimal(6, 2)
  englishGrade6    Decimal?          @map("english_grade_6") @db.Decimal(6, 2)
  englishGrade7    Decimal?          @map("english_grade_7") @db.Decimal(6, 2)
  englishGrade8    Decimal?          @map("english_grade_8") @db.Decimal(6, 2)
  englishGrade9    Decimal?          @map("english_grade_9") @db.Decimal(6, 2)
  historyScoreType String?           @map("history_score_type") @db.VarChar(20)
  historyGrade1    Decimal?          @map("history_grade_1") @db.Decimal(6, 2)
  historyGrade2    Decimal?          @map("history_grade_2") @db.Decimal(6, 2)
  historyGrade3    Decimal?          @map("history_grade_3") @db.Decimal(6, 2)
  historyGrade4    Decimal?          @map("history_grade_4") @db.Decimal(6, 2)
  historyGrade5    Decimal?          @map("history_grade_5") @db.Decimal(6, 2)
  historyGrade6    Decimal?          @map("history_grade_6") @db.Decimal(6, 2)
  historyGrade7    Decimal?          @map("history_grade_7") @db.Decimal(6, 2)
  historyGrade8    Decimal?          @map("history_grade_8") @db.Decimal(6, 2)
  historyGrade9    Decimal?          @map("history_grade_9") @db.Decimal(6, 2)
  historyMinReq    String?           @map("history_min_req") @db.VarChar(50)
  status           String            @default("존립") @db.VarChar(20)
  createdAt        DateTime          @default(now()) @map("created_at")
  updatedAt        DateTime          @updatedAt @map("updated_at")
  admissionCutoffs AdmissionCutoff[]
  university       University        @relation(fields: [universityId], references: [id])

  @@index([universityId])
  @@index([code])
  @@index([category, subCategory])
  @@map("eh_departments")
}

model AdmissionCutoff {
  id                 Int        @id @default(autoincrement())
  departmentId       Int        @map("department_id")
  mockExamId         Int?       @map("mock_exam_id")
  year               Int?
  scoreType          String?    @map("score_type") @db.VarChar(20)
  firstCutScore      Decimal?   @map("first_cut_score") @db.Decimal(10, 4)
  firstCutPercentile Decimal?   @map("first_cut_percentile") @db.Decimal(10, 6)
  finalCutScore      Decimal?   @map("final_cut_score") @db.Decimal(10, 4)
  finalCutPercentile Decimal?   @map("final_cut_percentile") @db.Decimal(10, 6)
  riskPlus5          Decimal?   @map("risk_plus_5") @db.Decimal(10, 6)
  riskPlus4          Decimal?   @map("risk_plus_4") @db.Decimal(10, 6)
  riskPlus3          Decimal?   @map("risk_plus_3") @db.Decimal(10, 6)
  riskPlus2          Decimal?   @map("risk_plus_2") @db.Decimal(10, 6)
  riskPlus1          Decimal?   @map("risk_plus_1") @db.Decimal(10, 6)
  riskMinus1         Decimal?   @map("risk_minus_1") @db.Decimal(10, 6)
  riskMinus2         Decimal?   @map("risk_minus_2") @db.Decimal(10, 6)
  riskMinus3         Decimal?   @map("risk_minus_3") @db.Decimal(10, 6)
  riskMinus4         Decimal?   @map("risk_minus_4") @db.Decimal(10, 6)
  riskMinus5         Decimal?   @map("risk_minus_5") @db.Decimal(10, 6)
  competitionRate    Decimal?   @map("competition_rate") @db.Decimal(6, 2)
  additionalRate     Decimal?   @map("additional_rate") @db.Decimal(6, 2)
  createdAt          DateTime   @default(now()) @map("created_at")
  department         Department @relation(fields: [departmentId], references: [id])
  mockExam           MockExam?  @relation(fields: [mockExamId], references: [id])

  @@index([departmentId])
  @@index([year])
  @@index([mockExamId])
  @@map("eh_admission_cutoffs")
}

model ScoreConversionStandard {
  id            Int      @id @default(autoincrement())
  mockExamId    Int      @map("mock_exam_id")
  subject       String   @db.VarChar(50)
  standardScore Int      @map("standard_score")
  percentile    Decimal? @db.Decimal(6, 2)
  grade         Int?
  cumulativePct Decimal? @map("cumulative_pct") @db.Decimal(10, 6)
  mockExam      MockExam @relation(fields: [mockExamId], references: [id])

  @@index([mockExamId])
  @@index([subject, standardScore])
  @@map("eh_score_conversion_standard")
}

model ScoreConversionRaw {
  id             Int      @id @default(autoincrement())
  mockExamId     Int      @map("mock_exam_id")
  subject        String   @db.VarChar(50)
  subjectType    String?  @map("subject_type") @db.VarChar(50)
  commonScore    Int?     @map("common_score")
  selectionScore Int?     @map("selection_score")
  standardScore  Int?     @map("standard_score")
  mockExam       MockExam @relation(fields: [mockExamId], references: [id])

  @@index([mockExamId])
  @@index([subject, subjectType])
  @@map("eh_score_conversion_raw")
}

model Mentoring {
  id          Int       @id @default(autoincrement())
  classId     String    @unique @map("class_id") @db.VarChar(30)
  grade       String?   @db.VarChar(10)
  subject     String?   @db.VarChar(10)
  startDate   DateTime? @map("start_date") @db.Date
  className   String?   @map("class_name") @db.VarChar(100)
  teacherName String?   @map("teacher_name") @db.VarChar(50)
  weeklyCount Int?      @map("weekly_count")
  duration    String?   @db.VarChar(10)
  day1        String?   @map("day_1") @db.VarChar(10)
  startTime1  DateTime? @map("start_time_1") @db.Time(6)
  endTime1    DateTime? @map("end_time_1") @db.Time(6)
  day2        String?   @map("day_2") @db.VarChar(10)
  startTime2  DateTime? @map("start_time_2") @db.Time(6)
  endTime2    DateTime? @map("end_time_2") @db.Time(6)
  fee         Int?      @default(0)
  feeType     String?   @map("fee_type") @db.VarChar(20)
  createdAt   DateTime  @default(now()) @map("created_at")

  @@index([grade])
  @@index([teacherName])
  @@map("eh_mentoring")
}

model AchievementResult {
  id              Int       @id @default(autoincrement())
  resultId        String    @unique @map("result_id") @db.VarChar(30)
  studentId       Int       @map("student_id")
  missionId       String?   @map("mission_id") @db.VarChar(30)
  date            DateTime? @db.Date
  startTime       DateTime? @map("start_time") @db.Time(6)
  endTime         DateTime? @map("end_time") @db.Time(6)
  category        String?   @db.VarChar(20)
  subject         String?   @db.VarChar(20)
  subCategory     String?   @map("sub_category") @db.VarChar(20)
  content         String?   @db.VarChar(100)
  amount          Int?
  achievementRate Decimal?  @map("achievement_rate") @db.Decimal(5, 2)
  correctCount    Int?      @map("correct_count")
  totalCount      Int?      @map("total_count")
  score           Int?
  focusLevel      Decimal?  @map("focus_level") @db.Decimal(5, 2)
  createdAt       DateTime  @default(now()) @map("created_at")
  student         Student   @relation(fields: [studentId], references: [id])

  @@index([studentId])
  @@index([date])
  @@map("eh_achievement_results")
}

model StudentAnswer {
  id              Int          @id @default(autoincrement())
  studentId       Int          @map("student_id")
  mockExamId      Int          @map("mock_exam_id")
  examQuestionId  Int          @map("exam_question_id")
  subjectAreaName String?      @map("subject_area_name") @db.VarChar(50)
  subjectName     String?      @map("subject_name") @db.VarChar(50)
  questionNumber  Int          @map("question_number")
  selectedAnswer  Int          @map("selected_answer")
  correctAnswer   Int          @map("correct_answer")
  isCorrect       Boolean      @map("is_correct")
  score           Int?         @default(2)
  earnedScore     Int?         @default(0) @map("earned_score")
  wrongReason     String?      @map("wrong_reason") @db.VarChar(200)
  reviewCount     Int          @default(0) @map("review_count")
  lastReviewedAt  DateTime?    @map("last_reviewed_at")
  isBookmarked    Boolean      @default(false) @map("is_bookmarked")
  createdAt       DateTime     @default(now()) @map("created_at")
  updatedAt       DateTime     @updatedAt @map("updated_at")
  examQuestion    ExamQuestion @relation(fields: [examQuestionId], references: [id])
  mockExam        MockExam     @relation(fields: [mockExamId], references: [id])
  student         Student      @relation(fields: [studentId], references: [id])

  @@unique([studentId, examQuestionId])
  @@index([studentId, mockExamId])
  @@index([studentId, isCorrect])
  @@index([studentId, subjectAreaName])
  @@map("eh_student_answers")
}
